## 18. Удаление элемента из пирамиды  
### Суть операции

**Удаление элемента из пирамиды (heap)** — это операция, при которой из структуры удаляется корневой элемент (чаще всего — **максимум** в max-heap или **минимум** в min-heap),  
а свойство пирамиды (**каждый родитель ≥ потомков** для max-heap) должно быть **восстановлено**.

### Идея удаления

Для **max-heap**:

1. Удаляем корень (наибольший элемент).
    
2. Переносим **последний элемент массива** на место корня.
    
3. Уменьшаем размер кучи на 1.
    
4. Вызываем `heapify_down(0)` — восстанавливаем свойство пирамиды.


### Реализация

```cpp
void heapify(int* arr, int n, int i) {
    int largest = i;
    int left = 2 * i + 1;
    int right = 2 * i + 2;

    if (left < n && arr[left] > arr[largest])
        largest = left;
    if (right < n && arr[right] > arr[largest])
        largest = right;

    if (largest != i) {
        std::swap(arr[i], arr[largest]);
        heapify(arr, n, largest);
    }
}

int remove_root(int* arr, int& n) {
    if (n <= 0) return -1; // пустая куча
    int root_value = arr[0];

    arr[0] = arr[n - 1]; // последний элемент на место корня
    n--;                 // уменьшаем размер
    heapify(arr, n, 0);  // восстанавливаем пирамиду

    return root_value;
}
```

### Асимптотика

`O(logn) + O(1) = O(logn)`

### Общие замечания

- Если требуется удалить **произвольный элемент**, а не только корень:
    
    - заменяем его последним элементом массива;
        
    - затем выполняем `heapify_up` или `heapify_down` (в зависимости от значения);
        
    - сложность остаётся `O(log n)`.

